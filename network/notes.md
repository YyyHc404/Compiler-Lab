

## python: 
#### 环回地址:
     数据将通过回环接口（loopback interface）发送和接收。回环接口是计算机内部的虚拟网络接口，用于在同一台计算机上的进程之间进行通信。
    环回地址只是用于本地进程通讯

#### 套接字：
        保存了进程所需网络的状态和数据结构，为应用程序提供了API进行网络通讯，对套接字操作时触发系统调用，操作系统进行网络通讯
#### 套接字类型:
- AF_PACKET 是一个直接连接网络设备的低层级接口。
- AF_HYPERV是一种地址族，用于与Hyper-V虚拟化平台通信。在Python的socket模块中，AF_HYPERV用于创建与Hyper-V之间的通信套接字。Hyper-V是微软的虚拟化平台，允许在Windows操作系统上创建和管理虚拟机。通过AF_HYPERV地址族，可以实现主机与虚拟机之间的通信，以及虚拟机之间的通信。
- AF_NETLINK 与内核通讯的地址簇
#### 其他:
- socket.ioctl 用于执行套接字的 I/O 控制操作
- socket.getaddrinfo    将地址和port等socket信息转换转换为
- Python的沙盒逃逸是指攻击者通过利用Python解释器中的漏洞或不安全的特性,执行未经授权的操作或者获取系统权限。 exec() 或 eval()


## 代理:
- SAN（Subject Alternative Name）证书是一种用于安全通信的数字证书，它可以为单个证书绑定多个域名或主机名
- CNAME 将域名指向另一个域名
- 缓存侦测


## 渗透
**信息收集**：
    - 基本信息: ip、域名、网段、端口
    - 系统信息:操作系统及其版本
    - 应用信息:所在端口
    - 服务信息: 高危服务，如文件共享服务
    - 人员信息: 域注册，管理
绕过CDN获取网站真实IP:
    - 通过内部邮箱

**漏洞探测**:
### 提权漏洞：
- 操作系统漏洞:
    1. 缓冲区溢出漏洞
    1. 特权提升漏洞
- 应用程序漏洞:
    1. 目录遍历漏洞
    1. 代码注入漏洞

**漏洞验证**:
    在模拟环境下测试，成功后应用与目标
**信息分析**：
    - 绕过检测机制、

**获取所需信息**：
    - 拓扑结构
    - 权限维持
    
站点下的常有文件:
- robots.txt  告诉爬虫哪些可以抓取，哪些不该
- crossdomain.xml  跨域策略
- sitemap.xml  网站结构化信息
- xx.tar.gz  用于传输的备份
- xx.bak    用于备份

**浏览器技巧**:
1. [link] [site] :domain [key] [inurl]   搜索此域名的所有网页  
###### 前缀:
- link 包含此链接的网页 
- related 相似链接
- intitle 标题为指定内容
###### 后缀:
- key 包含关键字   
- inurl  url中包含路径
- inurl:"nph-proxy.cgi" "Start browsing" 查找代理服务器
1. 快照：
    浏览器保存之前的页面

**钓鱼**:
- exe 文件混淆  通过编程在文件名中插入特殊unicode 字符
- RAR 自解压和加密传输逃避检查  https://github.com/WyAtu/CVE-2018-20250
- 利用MSF生成
- 利用CHM生成
- DDE（Dynamic Data Exchange）是一种Windows系统中用于应用程序之间进行数据交换的机制


"内部线束": 通常指的是软件中的一种技术，用于将特定功能或模块封装在一个单独的部分中，使得它们可以被轻松地调用和重用，而不必暴露给外部


### 数据格式和性质:
- **HTTP1.1** : 采用持续链接,即响应HTML后不关闭连接，继续发完结构中的内容
- **HTTP2.0**： 打开多个并行的TCP链接(单一持续的TCP链接)，解决队首阻塞的问题；性质: 成帧，多个对象分为多个帧，对象之间相互交错发送报文
- **SMTP(25)**：基于TCP的简单邮件传输协议
    命令:HELLO、MAIL FROM、REPT TO、DATA、QUIT

       用户代理 -> 邮件服务器（报文队列） -> 对方邮件服务器(邮箱) -> 目标用户
        
    - 用户代理将SMTP格式的文本交给邮件服务器处理，就不用与目标服务器对话
    每个报文内容以<CR><LF>.<CR><LF> 结束

    - 邮件内容被限制为用ASCLL码表示；现在发送邮件前会将媒体内容编码为ASCLL。
    邮箱服务器之间时没有中间服务器的，一对一发送。
    
**邮件报文格式**: 
- 由RFC 5322定义与SMTP命令不同;必须包含FROM : 和 TO :
- 现代常用方式是邮件服务器同时具有HTTP(将邮件发送/接受给客户端)和SMTP接口(发送接收/SMTP服务器邮件)

## DNS(53)基于UPD协议:
- 分层的分布式数据库
- 能使主机查询分布式数据库的应用层协议
- DNS通常是运行BIND软件的UNIX服务器
- 通常由其他协议所使用，如HTTP和SMTP
- DNS客户端和服务端
**用法**:
1. 主机别名
1. 邮件服务器别名
1. 负载分配
**分层服务器**:
- 根服务器
- 顶级域服务器
- 权威域服务器
- 本地DNS服务器 ISP的临近DNS
- 递归查询(获取下一个DNS返回的IP)、迭代查询(根据获取的DNS查询下一阶的DNS)


**DNS记录和报文**:
- 资源记录(RR): (Name, Value, Type, TTL)
- MX 邮件服务器别名，MX允许其他服务器和邮件服务器有相同别名，其他服务器应该用CNAME选择别名。
         条目格式: example.com. mail.example.com. MX
- SPF（Sender Policy Framework）是一种用于防止电子邮件地址伪造的技术，通过验证发件人的IP地址是否被授权发送电子邮件，从而减少垃圾邮件和欺诈邮件的发送。 
         条目格式: v=spf1 ip4:192.0.2.0/24 mx -all
    1. 软拒绝，仅仅标识为垃圾软件，根据邮件服务器的厂商也会有不同变化
    2. 地址范围过大就可以通过社会工程学获取一台主机发送
- A记录（Address Record）是一种DNS记录类型，用于将域名解析为IPv4地址
         条目格式: <域名> IN A <IPv4地址>
- NS (aa.com b.aa.com NS)  知道该域名权威DNS的记录，用于沿着查链连来路由DNS。
- TXT记录是一种DNS记录类型，用于存储文本信息。TXT记录可以包含任意文本信息，通常用于存储与域名相关的元数据、验证信息、安全策略等。
         条目格式: <域名> IN TXT "<文本信息>"
- DKIM（DomainKeys Identified Mail）是一种用于验证电子邮件的完整性和真实性的技术。通过DKIM，发件人可以将一个加密的数字签名附加到发送的电子邮件中，接收方可以使用公钥来验证该签名，以确认邮件的来源和完整性。
- eml中 FROM 和 TO 字段是为了显示的  sender是实际发送者

- 权威服务器应具有一条A记录;如果不是权威服务器，应具有一条NS记录(指向下一级DNS域)和A记录(下一级DNS的IP)

**报文格式**:
只有响应和请求报文，且报文格式相同
- 首部区域:
    

    1. 16 byte 标识符响应报文复制该请求报文标识符

    2. 1 byte  (查询/响应:0/1) 
        当时权威服务器时响应置  1
        执行递归查询   1
        响应递归可用  1

    3. 后四个字段表示体中对应的条目数量

- 问题区域:
    1. 被查询的主机名字
    2. 查询类型
- 回答区域:
    1. 最初的名字的资源记录RR

- 权威区域:
    包含其他权威DNS的记录

- 附加信息区域:
    例如MX类型请求，附加区域会包含其别名的IP

**DNS数据库中插入记录**:
- 注册登记机构:验证该域名的唯一性，将该域名插入DNS数据库
- ICANN:向各种注册登记机构授权
- 向权威服务器提交 NS 和 A记录(对于权威服务器)
- 确保WEB服务器的A记录和邮件服务器的MX记录输入权威DNS中（直到最近每台DNS都是静态配置的）
- 例如请求 www.aa.com会从本地DNS中查询权威服务器，TLD包含A记录和NS记录，返回TLD的IP，（因为已经注册了www和mail域）通过权威服务器返回www的IP
- 大部分DNS查询都绕过了根服务器

**网络设备**:
- Bridge:
        数据链路层
        连接将两个或多个不同网段的网络，并学习MAC地址来进行转发
**虚拟网络接口**:
- Bounds: 是指将多个物理网络接口绑定在一起，形成一个逻辑接口的网络配置
- VETH： 设备是一个本地以太网隧道（tunnel），该类设备总是成对创建。namespace 之间进行通信时，可以使用 VETH

- NAT（Network Address Translation，网络地址转换）是一种在计算机网络中常用的技术，用于将一个 IP 地址空间映射到另一个 IP 地址空间。NAT 最常见的用途是将一个局域网内的多个设备共享一个公共 IP 地址以访问 Internet。

- 当在 NAT 模式下运行时，WSL（Windows Subsystem for Linux）的虚拟网络接口会被映射到虚拟机管理程序（如 Hyper-V）的 NAT 网关。因此，虚拟接口无法直接ping到自己映射的网络接口，因为它们实际上是处于不同的网络上，需要经过 NAT 转换才能进行通信



## API 文档:
Python API :https://docs.python.org/zh-cn/3/library
RAR:https://research.checkpoint.com/2019/extracting-code-execution-from-winrar/
SPF测试: https://www.kitterman.com/spf/validate.html
